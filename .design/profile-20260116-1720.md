# Profile: 2026-01-16 17:20

## Config
- Games: 500
- Seed: 42
- Threads: 1
- skip_trivial: True
- enable_profiler: True
- Deck: Grey Ogre mirror (Mountain x20, Grey Ogre x20)
- Policy: random

## Throughput
- **Games/sec**: 441.20
- **Steps/sec**: 64,991
- **Total steps**: 73,652
- **Wall time**: 1.133s
- **Avg steps/game**: 147.3

## Breakdown

| Scope | Total | Count | % of env_step |
|-------|-------|-------|---------------|
| env_step | 0.995s | 73,652 | 100% |
| → game | 0.800s | 73,652 | 80.5% |
| → → tick | 0.500s | 73,652 | 50.2% |
| → → → turn | 0.456s | 255,425 | 45.8% |
| → → action_execute | 0.084s | 73,652 | 8.5% |
| → → skip_trivial | 0.126s | 12,432 | 12.7% |
| → → → tick | 0.115s | 12,432 | 11.5% |
| → → → → turn | 0.104s | 55,972 | 10.5% |
| → observation | 0.146s | 73,652 | 14.6% |
| → → populatePermanents | 0.054s | 73,652 | 5.4% |
| → → populateCards | 0.037s | 73,652 | 3.7% |
| → → populateTurn | 0.010s | 147,304 | 1.0% |
| → → populatePlayers | 0.005s | 73,652 | 0.5% |

## Step Type Breakdown (tick + skip_trivial combined)

| Step Type | Total | Count | Per-call |
|-----------|-------|-------|----------|
| PRECOMBAT_MAIN_STEP | 0.158s | 46,464 | 3.4us |
| POSTCOMBAT_MAIN_STEP | 0.093s | 30,222 | 3.1us |
| COMBAT_DECLARE_ATTACKERS | 0.045s | 54,434 | 0.8us |
| COMBAT_DECLARE_BLOCKERS | 0.031s | 42,787 | 0.7us |
| COMBAT_DAMAGE | 0.031s | 19,089 | 1.6us |
| BEGINNING_DRAW | 0.029s | 18,624 | 1.5us |
| COMBAT_BEGIN | 0.021s | 19,089 | 1.1us |
| BEGINNING_UPKEEP | 0.020s | 18,624 | 1.1us |
| COMBAT_END | 0.019s | 18,624 | 1.0us |
| ENDING_END | 0.019s | 18,624 | 1.0us |
| BEGINNING_UNTAP | 0.008s | 18,624 | 0.4us |
| ENDING_CLEANUP | 0.007s | 18,624 | 0.4us |

## Key Metrics

- **Tick amplification**: 311,397 turn ticks for 73,652 steps (4.2x)
- **Observation time**: 14.6% of total (0.146s)
- **Turn hierarchy time**: 56.3% of total (tick + skip_trivial turn combined)
- **Main phases dominate**: PRECOMBAT_MAIN_STEP + POSTCOMBAT_MAIN_STEP = 0.251s (25.2% of env_step)

## Priority Breakdown

Within main steps, priority checking dominates:
- PRECOMBAT_MAIN_STEP/priority: 0.074s (7.4% of total, 1.7us/call)
- POSTCOMBAT_MAIN_STEP/priority: 0.029s (2.9% of total, 1.3us/call)

Total priority scope time within main tick: ~0.15s (15% of env_step)

## Comparison to Previous

This is the first profile on the perf branch after all optimizations.

Previous documented throughput from .design/perf.md:
- Post early-out: 70,827 steps/sec
- Current: 64,991 steps/sec (-8.2%)

The slight regression may be due to:
1. Added per-step-type instrumentation overhead (step/<TYPE> scopes)
2. Normal benchmark variance

## Raw
```
env_step: total=0.994804s, count=73652
env_step/game: total=0.800322s, count=73652
env_step/game/action_execute: total=0.0840947s, count=73652
env_step/game/skip_trivial: total=0.126383s, count=12432
env_step/game/skip_trivial/action_execute: total=0.00083439s, count=12432
env_step/game/skip_trivial/tick: total=0.114705s, count=12432
env_step/game/skip_trivial/tick/turn: total=0.104212s, count=55972
env_step/game/skip_trivial/tick/turn/step/BEGINNING_DRAW: total=0.00566182s, count=3585
env_step/game/skip_trivial/tick/turn/step/BEGINNING_DRAW/priority: total=0.00161401s, count=3585
env_step/game/skip_trivial/tick/turn/step/BEGINNING_UNTAP: total=0.00158606s, count=3585
env_step/game/skip_trivial/tick/turn/step/BEGINNING_UPKEEP: total=0.00391708s, count=3585
env_step/game/skip_trivial/tick/turn/step/BEGINNING_UPKEEP/priority: total=0.0016397s, count=3585
env_step/game/skip_trivial/tick/turn/step/COMBAT_DAMAGE: total=0.00815664s, count=7346
env_step/game/skip_trivial/tick/turn/step/COMBAT_DAMAGE/priority: total=0.00283379s, count=7346
env_step/game/skip_trivial/tick/turn/step/COMBAT_DECLARE_BLOCKERS: total=0.00933439s, count=12432
env_step/game/skip_trivial/tick/turn/step/COMBAT_DECLARE_BLOCKERS/priority: total=0.00294995s, count=7346
env_step/game/skip_trivial/tick/turn/step/COMBAT_END: total=0.0074677s, count=7346
env_step/game/skip_trivial/tick/turn/step/COMBAT_END/priority: total=0.0028106s, count=7346
env_step/game/skip_trivial/tick/turn/step/ENDING_CLEANUP: total=0.00134898s, count=3585
env_step/game/skip_trivial/tick/turn/step/ENDING_END: total=0.00364043s, count=3585
env_step/game/skip_trivial/tick/turn/step/ENDING_END/priority: total=0.00135134s, count=3585
env_step/game/skip_trivial/tick/turn/step/POSTCOMBAT_MAIN_STEP: total=0.0271938s, count=7346
env_step/game/skip_trivial/tick/turn/step/POSTCOMBAT_MAIN_STEP/priority: total=0.00824006s, count=7346
env_step/game/skip_trivial/tick/turn/step/PRECOMBAT_MAIN_STEP: total=0.0185148s, count=3577
env_step/game/skip_trivial/tick/turn/step/PRECOMBAT_MAIN_STEP/priority: total=0.00590531s, count=3577
env_step/game/tick: total=0.499858s, count=73652
env_step/game/tick/turn: total=0.455676s, count=255425
env_step/game/tick/turn/step/BEGINNING_DRAW: total=0.0232261s, count=15039
env_step/game/tick/turn/step/BEGINNING_DRAW/priority: total=0.0067576s, count=15039
env_step/game/tick/turn/step/BEGINNING_UNTAP: total=0.00673873s, count=15039
env_step/game/tick/turn/step/BEGINNING_UPKEEP: total=0.0159424s, count=15039
env_step/game/tick/turn/step/BEGINNING_UPKEEP/priority: total=0.00686777s, count=15039
env_step/game/tick/turn/step/COMBAT_BEGIN: total=0.0207191s, count=19089
env_step/game/tick/turn/step/COMBAT_BEGIN/priority: total=0.00852815s, count=19089
env_step/game/tick/turn/step/COMBAT_DAMAGE: total=0.0234054s, count=11743
env_step/game/tick/turn/step/COMBAT_DAMAGE/priority: total=0.0117923s, count=11743
env_step/game/tick/turn/step/COMBAT_DECLARE_ATTACKERS: total=0.0355478s, count=42002
env_step/game/tick/turn/step/COMBAT_DECLARE_ATTACKERS/priority: total=0.00819876s, count=19089
env_step/game/tick/turn/step/COMBAT_DECLARE_BLOCKERS: total=0.0223479s, count=30355
env_step/game/tick/turn/step/COMBAT_DECLARE_BLOCKERS/priority: total=0.0048141s, count=11743
env_step/game/tick/turn/step/COMBAT_END: total=0.0115269s, count=11278
env_step/game/tick/turn/step/COMBAT_END/priority: total=0.00438925s, count=11278
env_step/game/tick/turn/step/ENDING_CLEANUP: total=0.00550065s, count=15039
env_step/game/tick/turn/step/ENDING_END: total=0.0151897s, count=15039
env_step/game/tick/turn/step/ENDING_END/priority: total=0.00597719s, count=15039
env_step/game/tick/turn/step/POSTCOMBAT_MAIN_STEP: total=0.066267s, count=22876
env_step/game/tick/turn/step/POSTCOMBAT_MAIN_STEP/priority: total=0.0288022s, count=22876
env_step/game/tick/turn/step/POSTCOMBAT_MAIN_STEP/priority/priority: total=0.00501781s, count=3833
env_step/game/tick/turn/step/PRECOMBAT_MAIN_STEP: total=0.139721s, count=42887
env_step/game/tick/turn/step/PRECOMBAT_MAIN_STEP/priority: total=0.0736704s, count=42887
env_step/game/tick/turn/step/PRECOMBAT_MAIN_STEP/priority/priority: total=0.0153948s, count=9006
env_step/observation: total=0.145683s, count=73652
env_step/observation/populateCards: total=0.036557s, count=73652
env_step/observation/populatePermanents: total=0.0540001s, count=73652
env_step/observation/populatePlayers: total=0.00532533s, count=73652
env_step/observation/populateTurn: total=0.00993603s, count=147304
```
