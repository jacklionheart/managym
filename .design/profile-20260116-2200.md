# Profile: 2026-01-16-2200

## Config
Games: 500, Seed: 42, Threads: 1
Deck: Grey Ogre mirror, Policy: random

## Throughput
- 288.60 games/sec
- 42,513 steps/sec
- 147.3 steps/game avg

## Delta vs Previous (20260116-post-infodict)

| Metric | Previous | Current | Change |
|--------|----------|---------|--------|
| Steps/sec | 39,097 | 42,513 | **+8.7%** |
| env_step total | 1.738s | 1.586s | **-8.8%** |
| Per-step time | 23.6μs | 21.5μs | **-8.9%** |
| game | 1.558s (89.6%) | 1.402s (88.4%) | -10.0% |
| observation | 0.148s (8.5%) | 0.149s (9.4%) | +0.7% |

**Note:** This improvement is from removing the `phase` and `step` profiler scopes from `turn.cpp`. Now only `turn` and `priority` scopes remain in the turn hierarchy.

## Breakdown
| Scope | Total | Count | % |
|-------|-------|-------|---|
| env_step | 1.586s | 73,652 | 100% |
| env_step/game | 1.402s | 73,652 | 88.4% |
| env_step/game/action_execute | 0.085s | 73,652 | 5.4% |
| env_step/game/skip_trivial | 1.098s | 400,128 | 69.2% |
| env_step/game/skip_trivial/action_execute | 0.055s | 400,128 | 3.5% |
| env_step/game/skip_trivial/tick | 0.777s | 400,128 | 49.0% |
| env_step/game/skip_trivial/tick/turn | 0.671s | 625,441 | 42.3% |
| env_step/game/skip_trivial/tick/turn/priority | 0.234s | 556,702 | 14.8% |
| env_step/game/skip_trivial/tick/turn/priority/priority | 0.019s | 12,839 | 1.2% |
| env_step/game/tick | 0.087s | 73,652 | 5.5% |
| env_step/game/tick/turn | 0.075s | 73,652 | 4.7% |
| env_step/game/tick/turn/priority | 0.040s | 58,532 | 2.5% |
| env_step/observation | 0.149s | 73,652 | 9.4% |
| (unaccounted) | 0.035s | - | 2.2% |

## Amplification Ratios
- Agent steps: 73,652
- Skip trivial iterations: 400,128 (5.4x agent steps)
- Turn ticks (inside skip_trivial): 625,441 (8.5x agent steps)
- Priority ticks (inside skip_trivial): 556,702 (7.6x agent steps)
- Inner priority (actual decisions): 12,839 (0.17x agent steps = 97.9% trivial)

## Key Observations

1. **Profiler scope reduction worked**: Removing `phase` and `step` scopes gave +8.7% steps/sec improvement.

2. **Skip-trivial loop dominates**: 69.2% of env_step time (1.098s) is in the skip_trivial loop.

3. **Turn hierarchy still the hotspot**: 42.3% of env_step time (0.671s) is in turn ticks inside skip_trivial.

4. **Observation remains efficient**: 9.4% of time (0.149s) — stable.

5. **Unaccounted time is minimal**: Only 2.2% (0.035s) — the profiler now captures most of the work.

## Cumulative Improvements

| Optimization | Profile | Steps/sec | vs Baseline |
|--------------|---------|-----------|-------------|
| Baseline (lazy obs, vectors) | 20260116-1614 | 16,122 | — |
| + cached playersStartingWithActive | 20260116-1631 | 16,607 | +3.0% |
| + InfoDict only at episode end | post-infodict | 39,097 | +142% |
| + Remove phase/step profiler scopes | **current** | 42,513 | **+164%** |

## Raw
```
env_step: total=1.58586s, count=73652
env_step/game: total=1.40179s, count=73652
env_step/game/action_execute: total=0.085241s, count=73652
env_step/game/skip_trivial: total=1.09801s, count=400128
env_step/game/skip_trivial/action_execute: total=0.0551825s, count=400128
env_step/game/skip_trivial/tick: total=0.776715s, count=400128
env_step/game/skip_trivial/tick/turn: total=0.671239s, count=625441
env_step/game/skip_trivial/tick/turn/priority: total=0.234419s, count=556702
env_step/game/skip_trivial/tick/turn/priority/priority: total=0.0191215s, count=12839
env_step/game/tick: total=0.086796s, count=73652
env_step/game/tick/turn: total=0.0751566s, count=73652
env_step/game/tick/turn/priority: total=0.0396393s, count=58532
env_step/observation: total=0.148541s, count=73652
env_step/observation/populateCards: total=0.0371325s, count=73652
env_step/observation/populatePermanents: total=0.0555937s, count=73652
env_step/observation/populatePlayers: total=0.00539986s, count=73652
env_step/observation/populateTurn: total=0.010151s, count=147304
```

## Behavior Stats (Hero)

| Metric | Value |
|--------|-------|
| win_rate | 0.50 |
| games_played | 500 |
| avg_game_length | 19.41 turns |
| land_play_rate | 0.84 |
| lands_played | 6,318 |
| spell_cast_rate | 1.07 |
| spells_cast | 24,423 |
| attack_rate | 0.49 |
| attacks_declared | 6,040 |
| block_rate | 0.25 |
| blocks_declared | 3,063 |
| mana_efficiency | 0.18 |
