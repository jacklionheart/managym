# Profile: 2026-01-16-1655

## Config
Games: 500, Seed: 42, Threads: 1
Deck: Grey Ogre mirror, Policy: random

## Throughput
- 240.25 games/sec
- 35,389 steps/sec
- 147.3 steps/game avg

## Delta vs Previous (20260116-post-infodict)

| Metric | Previous | Current | Change |
|--------|----------|---------|--------|
| Steps/sec | 39,097 | 35,389 | **-9.5%** |
| env_step total | 1.738s | 1.932s | +11.2% |
| Per-step time | 23.6μs | 26.2μs | +11.0% |
| game | 1.558s (89.6%) | 1.739s (90.1%) | +11.6% |
| observation | 0.148s (8.5%) | 0.153s (7.9%) | +3.4% |

**Note:** The previous profile (post-infodict) did not have the `skip_trivial` profiler scope instrumented inside the skip loop. This run includes that instrumentation, which adds overhead. The actual code is unchanged—this is measurement overhead from additional profiler scopes.

## Breakdown
| Scope | Total | Count | % |
|-------|-------|-------|---|
| env_step | 1.932s | 73,652 | 100% |
| env_step/game | 1.739s | 73,652 | 90.1% |
| env_step/game/action_execute | 0.087s | 73,652 | 4.5% |
| env_step/game/skip_trivial | 1.399s | 400,128 | 72.4% |
| env_step/game/skip_trivial/action_execute | 0.057s | 400,128 | 3.0% |
| env_step/game/skip_trivial/tick | 1.069s | 400,128 | 55.3% |
| env_step/game/skip_trivial/tick/turn | 0.960s | 625,441 | 49.7% |
| env_step/game/skip_trivial/tick/turn/phase | 0.834s | 625,441 | 43.2% |
| env_step/game/skip_trivial/tick/turn/phase/step | 0.684s | 625,441 | 35.4% |
| env_step/game/skip_trivial/tick/turn/phase/step/priority | 0.242s | 556,702 | 12.5% |
| env_step/game/skip_trivial/tick/turn/phase/step/priority/priority | 0.020s | 12,839 | 1.0% |
| env_step/game/tick | 0.119s | 73,652 | 6.1% |
| env_step/game/tick/turn | 0.107s | 73,652 | 5.5% |
| env_step/game/tick/turn/phase | 0.093s | 73,652 | 4.8% |
| env_step/game/tick/turn/phase/step | 0.074s | 73,652 | 3.8% |
| env_step/game/tick/turn/phase/step/priority | 0.041s | 58,532 | 2.1% |
| env_step/observation | 0.153s | 73,652 | 7.9% |
| (unaccounted) | 0.040s | - | 2.1% |

## Amplification Ratios
- Agent steps: 73,652
- Skip trivial iterations: 400,128 (5.4x agent steps)
- Turn/phase/step ticks (inside skip_trivial): 625,441 (8.5x agent steps)
- Priority ticks (inside skip_trivial): 556,702 (7.6x agent steps)
- Inner priority (actual decisions): 12,839 (0.17x agent steps = 97.9% trivial)

## Key Observations

1. **Skip-trivial dominates**: 72.4% of env_step time (1.399s) is spent in the skip_trivial loop, handling 400,128 trivial action auto-executions for 73,652 agent steps (5.4x amplification).

2. **Turn hierarchy inside skip_trivial**: 49.7% of env_step time (0.960s) is spent in turn/phase/step traversal within the skip_trivial loop.

3. **Non-trivial path is efficient**: The tick path outside skip_trivial only takes 6.1% (0.119s) for the 73,652 agent decisions.

4. **Observation remains efficient**: 7.9% of time (0.153s) — consistent with previous profiles.

5. **Profiler overhead visible**: The 9.5% slowdown from previous profile is likely due to the additional profiler scopes inside skip_trivial (400k+ scope creations/destructions).

## Time Distribution Analysis

**Where time goes (simplified):**
- Skip-trivial loop: 72.4% (1.399s)
  - Turn hierarchy traversal: 49.7% (0.960s)
  - Tick loop: 55.3% (1.069s)
  - Action execution: 3.0% (0.057s)
- Non-trivial tick: 6.1% (0.119s)
- Observation: 7.9% (0.153s)
- Action execution (non-trivial): 4.5% (0.087s)
- Unaccounted: 2.1% (0.040s)

**The bottleneck is clear:** The turn/phase/step hierarchy is traversed 625,441 times, but only 12,839 of those (2.1%) produce actual player decisions. The refactor proposals (flat state machine, integrated skip-trivial) directly target this.

## Raw
```
env_step: total=1.93151s, count=73652
env_step/game: total=1.73938s, count=73652
env_step/game/action_execute: total=0.0870877s, count=73652
env_step/game/skip_trivial: total=1.39891s, count=400128
env_step/game/skip_trivial/action_execute: total=0.0572525s, count=400128
env_step/game/skip_trivial/tick: total=1.06855s, count=400128
env_step/game/skip_trivial/tick/turn: total=0.959915s, count=625441
env_step/game/skip_trivial/tick/turn/phase: total=0.834399s, count=625441
env_step/game/skip_trivial/tick/turn/phase/step: total=0.683523s, count=625441
env_step/game/skip_trivial/tick/turn/phase/step/priority: total=0.24215s, count=556702
env_step/game/skip_trivial/tick/turn/phase/step/priority/priority: total=0.0196939s, count=12839
env_step/game/tick: total=0.118715s, count=73652
env_step/game/tick/turn: total=0.10666s, count=73652
env_step/game/tick/turn/phase: total=0.0931893s, count=73652
env_step/game/tick/turn/phase/step: total=0.0741s, count=73652
env_step/game/tick/turn/phase/step/priority: total=0.041062s, count=58532
env_step/observation: total=0.152875s, count=73652
env_step/observation/populateCards: total=0.0383347s, count=73652
env_step/observation/populatePermanents: total=0.0564614s, count=73652
env_step/observation/populatePlayers: total=0.00539483s, count=73652
env_step/observation/populateTurn: total=0.0105886s, count=147304
```

## Behavior Stats (Hero)

| Metric | Value |
|--------|-------|
| win_rate | 0.50 |
| games_played | 500 |
| avg_game_length | 19.41 turns |
| land_play_rate | 0.84 |
| lands_played | 6,318 |
| spell_cast_rate | 1.07 |
| spells_cast | 24,423 |
| attack_rate | 0.49 |
| attacks_declared | 6,040 |
| block_rate | 0.25 |
| blocks_declared | 3,063 |
| mana_efficiency | 0.18 |
